<!doctype html>
<html lang="fr">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
          integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <!--    <link href="../dist/css/bootstrap.min.css" rel="stylesheet" media="screen">-->
    <link href="../dist/css/bootstrap4-modif.css" rel="stylesheet" media="screen">
    <link href="../dist/css/docs.min.css" rel="stylesheet">
    <link href="../dist/css/docs.perso.css" rel="stylesheet">
    <title>PHP - transmettre des données</title>
    <script>
        // window.ga = window.ga || function () {
        //     (ga.q = ga.q || []).push(arguments)
        // };
        // ga.l = +new Date;
        // ga('create', 'UA-146052-10', 'chchabin.free.fr');
        // ga('set', 'anonymizeIp', true);
        // ga('send', 'pageview');
    </script>
</head>
<body>
<a class="skippy sr-only sr-only-focusable" href="#content">
    <span class="skippy-text">Skip to main content</span>
</a>
<!--        navbar-->
<header class="navbar navbar-expand navbar-dark flex-column flex-md-row bd-navbar">
    <a class="navbar-brand mr-0 mr-md-2" href="/" aria-label="Bootstrap">

    </a>

    <div class="navbar-nav-scroll">
        <ul class="navbar-nav bd-navbar-nav flex-row">
            <li class="nav-item">
                <a class="nav-link " href="php01Gintroduction.html"
                   onclick="ga('send', 'event', 'Navbar', 'Community links', 'Bootstrap');">Guide PHP</a>
            </li>
            <li class="nav-item">
                <a class="nav-link active" href="index.html"
                   onclick="ga('send', 'event', 'Navbar', 'Community links', 'Docs');">Documentation</a>
            </li>
        </ul>
    </div>
</header>
<div class="container-fluid">
    <div class="row flex-xl-nowrap">
        <!--        Menu Gauche-->
        <div class="col-12 col-md-3 col-xl-2 bd-sidebar">
            <nav class="collapse bd-links" id="bd-docs-nav">
                <div class="bd-toc-item">
                    <a class="bd-toc-link " href="php01Gintroduction.html">
                        I - Introduction au développement Web
                    </a>

                    <ul class="nav bd-sidenav">
                        <li>
                            <a href="#foncweb">
                                A - Le fonctionnement du Web
                            </a>
                        </li>
                        <li>
                            <a href="#protocole-HTTP">
                                B - Le protocole HTTP
                            </a>
                        </li>
                        <li>
                            <a href="#siteDyn">C - L'évolution vers des sites dynamiques
                            </a>
                        </li>
                    </ul>
                </div>
                <div class="bd-toc-item ">
                    <a class="bd-toc-link" href="php02Gbaseslg.html">
                        II - Les bases du langage
                    </a>
                </div>
                <div class="bd-toc-item">
                    <a class="bd-toc-link" href="php031ProgPhp_Variables.html">
                        III - Programmer avec PHP
                    </a>

                    <ul class="nav bd-sidenav">
                        <li>
                            <a href="#variables">A - Les variables
                            </a>
                        </li>
                        <li>
                            <a href="#tests">B - Tests et conditions
                            </a>
                        </li>
                        <li>
                            <a href="#tableau">C - Les tableaux
                            </a>
                        </li>
                        <li>
                            <a href="#boucles">D - Les boucles
                            </a>
                        </li>
                        <li>
                            <a href="#fonctions"> E - Les fonctions
                            </a>
                        </li>
                    </ul>
                </div>
                <div class="bd-toc-item">
                    <a class="bd-toc-link" href="php041Transmission.html">
                        IV - Transmettre des données entre des pages
                    </a>

                    <ul class="nav bd-sidenav">
                        <li>
                            <a href="#superglobale">A - Notion de variable superglobale
                            </a>
                        </li>
                        <li>
                            <a href="#transmissionURL">B - Transmission via l'URL
                            </a>
                        </li>
                        <li>
                            <a href="#transmissionForm">C - Transmission via un formulaire
                            </a>
                        </li>
                        <li>
                            <a href="#transmissionData">D - Transmission de données et sécurité
                            </a>
                        </li>
                        <li>
                            <a href="#transmissionSession">E - Transmission via la session
                            </a>
                        </li>
                    </ul>
                </div>
                <div class="bd-toc-item active">
                    <a class="bd-toc-link" href="php05AccesSGBD_Introduction.html">
                        V - Accéder à une base de données
                    </a>

                    <ul class="nav bd-sidenav">
                        <li>
                            <a href="php05AccesSGBD_Introduction.html"> A - Introduction
                            </a>
                        </li>
                        <li>
                            <a href="php05AccesSGBD_Connexion.html">B - Connexion à la base de données
                            </a>
                        </li>
                        <li>
                            <a href="php05AccesSGBD_RappelSQL.html">C - Rappel SQL avec <code>SELECT</code>
                            </a>
                        </li>
                        <li>
                            <a href="php05AccesSGBD_RqtSimple.html">D - <code>query</code> - Requêtes simples
                            </a>
                        </li>
                        <li>
                            <a href="php05AccesSGBD_RqtParam.html">E - <code>prepare</code> et <code>execute</code> -
                                Requêtes avec paramètres
                            </a>
                        </li>
                        <li>
                            <a href="php05AccesSGBD_RqtLMD.html">F - Le cas particulier avec <code>INSERT</code>, <code>UPDATE</code>,
                                <code>DELETE</code> et <code>exec</code>
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>

        </div>
        <!--        Menu droite-->
        <div class="d-none d-xl-block col-xl-2 bd-toc">
            <ul class="section-nav">
                <li class="toc-entry toc-h3"><a href="#ligneseule">1 - Le cas où une seule ligne est renvoyée</a></li>
                <li class="toc-entry toc-h2"><a href="#lignPlusieurs">2 - Le cas où plusieurs lignes sont renvoyées</a>
                </li>

            </ul>
        </div>
        <!--        Page de cours-->
        <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 bd-content" role="main">
            <h1 class="bd-title" id="content"> V - Accéder à une base de données</h1>

            <h2 id="sgbdRequeteSimple">D - <code>query</code> - Requêtes simples</h2>
            <section>
                <p>La méthode <code>query</code> de la classe <code>PDO</code> permet d'exécuter une requête SQL
                    simple (sans paramètres).</p>
                <figure class="highlight"><pre><code class="language-php" data-lang="php"><span
                        class="c">// ...</span>
$requete = "<span class="cp">select</span> * <span class="cp">from</span> employe";
$resultat = $bdd-&gt;<span class="s">query</span>($requete);</code></pre>
                </figure>
                <p>Le symbole <code>-&gt;</code> est l'équivalent PHP du symbole <code>.</code> utilisé dans
                    d'autres langages comme Java ou C#.
                    <br>L'instruction <code>$bdd-&gt;query</code> se lit : "J'appelle la
                    méthode <code>query</code> sur mon objet <code>$bdd</code>".</p>
                <p>Après l'appel à <code>query</code>, on peut parcourir le résultat ligne par ligne en appelant à
                    la
                    méthode <code>fetch</code> sur le résultat de la requête.</p>
                <h3 id="ligneseule">1 - Le cas où une seule ligne est renvoyée</h3>
                <article>
                    <ul>
                        <li>Dans le cas d'une requête qui renvoie une seule ligne de résultat, un seul appel à
                            <code>fetch</code> suffit. C'est notamment le cas lorsqu'on recherche un enregistrement à
                            partir
                            de sa clé primaire.
                        </li>
                    </ul>
                    <figure class="highlight"><pre><code class="language-php" data-lang="php"><span
                            class="c">// ...</span>
$requete = "<span class="cp">select</span> * <span class="cp">from</span> employe <span class="cp">where</span> id=1;";
$resultat = $bdd-&gt;<span class="s">query</span>($requete);
$ligne = $resultat-&gt;<span class="s">fetch</span>();
<span class="c">// On accède à la valeur de macolonne avec $ligne['macolonne'];</span></code></pre>
                    </figure>
                </article>
                <h3 id="lignPlusieurs">2 - Le cas où plusieurs lignes sont renvoyées</h3>
                <article>
                    <ul>
                        <li>Si la requête renvoie plusieurs lignes de résultats, on peut itérer sur ces lignes avec une
                            boucle <code>while</code> ou une boucle <code>foreach</code>.
                        </li>
                    </ul>
                    <h5> boucle <code>while</code></h5>
                    <figure class="highlight"><pre><code class="language-php" data-lang="php"><span
                            class="c">// ...</span>
$requete = "<span class="cp">select</span> * <span class="cp">from</span> employe";
$resultat = $bdd-&gt;<span class="s">query</span>($requete);

<span class="c">// Itération sur les résultats de la requête SQL</span>
<span class="s">while</span>($ligne = $resultat-&gt;<span class="s">fetch</span>()) {
    <span class="c">// On accède à la valeur de macolonne avec $ligne['macolonne'];</span>
    <span class="c">// ...</span>
}</code></pre>
                    </figure>
                    <h5> boucle <code>foreach</code></h5>
                    <figure class="highlight"><pre><code class="language-php" data-lang="php"><span
                            class="c">// ...</span>
$requete = "<span class="cp">select</span> * <span class="cp">from</span> employe";
$resultat = $bdd-&gt;<span class="s">query</span>($requete);

<span class="c">// Récupération de tous les résultats de la requête dans un tableau</span>
$donnees = $resultat-&gt;<span class="s">fetchAll</span>();
<span class="c">// Itération sur le contenu du tableau</span>
<span class="s">foreach</span>($donnees <span class="s">as</span> $ligne) {
    <span class="c">// On accède à la valeur de macolonne avec $ligne['macolonne'];</span>
    <span class="c">// ...</span>
}</code></pre>
                    </figure>
                    <p>Dans tous les cas, la variable <code>$ligne</code> s'utilise comme un tableau associatif. Elle
                        rassemble les valeurs des différentes colonnes pour une ligne de résultat SQL.</p>
                    <div class="bd-callout bd-callout-warning">
                        <h4><code>fetch</code> ou <code>fetchAll</code></h4>
                        <p><code>fetch</code> est utilisé dans le cas où vous êtes <strong>sûr</strong> que votre
                            requête
                            renvoie une seule ligne.</p>
                        <p><code>fetchAll</code> est utilisé dans le cas où la requête vous renvoie plusieurs lignes.
                            Généralement c'est un tableau qui est renvoyé. Mais avec la gestion des paramètres il est
                            possible d'obtenir un objet, par exemple.</p>
                    </div>
                </article>
            </section>

        </main>
    </div>
</div>
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
        integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
        crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
        integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
        crossorigin="anonymous"></script>
<!--<script src="../js/jquery-3.3.1.slim.min.js"></script>-->
<!--<script src="../js/popper.min.js"></script>-->
<!--<script src="../js/bootstrap.min.js"></script>-->
<script src="../js/docs.min.js"></script>
</body>
</html>