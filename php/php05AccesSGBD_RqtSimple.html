<!doctype html>
<html lang="fr">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link href="../dist/5.0/css/bootstrap.min.css" rel="stylesheet" media="screen">
       <link href="../dist/5.0/css/docs.css" rel="stylesheet">
    <link rel="icon" type="image/png"  href="../img/favicon.png">
    <title>PHP - transmettre des données</title>

</head>
<body>

<!--        navbar-->
<header class="navbar navbar-expand-md navbar-dark bd-navbar bg-success">
    <nav class="container-xxl flex-wrap flex-md-nowrap" aria-label="Main navigation">
        <div class="collapse navbar-collapse" id="bdNavbar">
            <ul class="navbar-nav flex-row flex-wrap bd-navbar-nav pt-2 py-md-0">
                <li class="nav-item">
                    <a class="nav-link " href="php01Gintroduction.html">Guide PHP</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link active" href="index.html">Documentation</a>
                </li>
            </ul>
        </div>
    </nav>
</header>
<nav class="bd-subnavbar py-2" aria-label="Secondary navigation"></nav>
<div class="container-xxl my-md-4 bd-layout">
    <!--        Menu Gauche-->
    <aside class="bd-sidebar">
        <nav class="collapse bd-links" id="bd-docs-nav" aria-label="Docs navigation">
            <ul class="list-unstyled mb-0 py-3 pt-md-1">
               <li class="mb-1">
                    <button class="btn d-inline-flex align-items-center rounded collapsed text-start justify-content-start" data-bs-toggle="collapse" data-bs-target="#php01Gintroduction" aria-expanded="false">
                        I - Introduction au développement Web
                    </button>
                    <div class="collapse" id="php01Gintroduction">
                        <ul class="list-unstyled fw-normal pb-1 small">
                            <li>
                                <a class="d-inline-flex align-items-center rounded collapsed" href="php01Gintroduction.html#foncweb">
                                    Principes de fonctionnement du Web
                                </a>
                            </li>
                        </ul>
                    </div>
                </li>
                <li class="mb-1">
                    <button class="btn d-inline-flex align-items-center rounded collapsed text-start"
                            data-bs-toggle="collapse" data-bs-target="#php02Gbaseslg" aria-expanded="false">
                        II - Les bases du langage
                    </button>
                    <div class="collapse" id="php02Gbaseslg">

                        <ul class="list-unstyled fw-normal pb-1 small">
                            <li>
                                <a class="d-inline-flex align-items-center rounded collapsed"
                                   href="php02Gbaseslg.html">Les bases du langage
                                </a>
                            </li>
                        </ul>
                    </div>
                </li>
                <li class="mb-1">
                    <button class="btn d-inline-flex align-items-center rounded collapsed text-start"
                            data-bs-toggle="collapse" data-bs-target="#php031ProgPhp_Variables" aria-expanded="false">
                        III - Programmer avec PHP
                    </button>
                    <div class="collapse" id="php031ProgPhp_Variables">

                        <ul class="list-unstyled fw-normal pb-1 small">
                            <li>
                                <a class="d-inline-flex align-items-center rounded collapsed"
                                   href="php031ProgPhp_Variables.html">A - Les variables
                                </a>
                            </li>
                            <li>
                                <a class="d-inline-flex align-items-center rounded collapsed"
                                   href="php032ProgPhp_Tests.html">B - Tests et conditions
                                </a>
                            </li>
                            <li>
                                <a class="d-inline-flex align-items-center rounded collapsed"
                                   href="php033ProgPhp_Tableaux.html">C - Les tableaux
                                </a>
                            </li>
                            <li>
                                <a class="d-inline-flex align-items-center rounded collapsed"
                                   href="php034ProgPhp_Boucles.html">D - Les boucles
                                </a>
                            </li>
                            <li>
                                <a class="d-inline-flex align-items-center rounded collapsed"
                                   href="php035ProgPhp_Fonctions.html"> E - Les fonctions
                                </a>
                            </li>
                            <li>
                                <a class="d-inline-flex align-items-center rounded collapsed"
                                   href="php036ProgPhp_Raccourcis.html"> F - Les raccourcis
                                </a>
                            </li>
                        </ul>
                    </div>
                </li>
                <li class="mb-1">
                    <button class="btn d-inline-flex align-items-center rounded collapsed text-start"
                            data-bs-toggle="collapse" data-bs-target="#php041Transmission" aria-expanded="false">
                        IV - Transmettre des données entre des pages
                    </button>
                    <div class="collapse" id="php041Transmission">

                        <ul class="list-unstyled fw-normal pb-1 small">
                            <li>
                                <a class="d-inline-flex align-items-center rounded collapsed"
                                   href="php041Transmission.html">A - Notion de variable superglobale
                                </a>
                            </li>
                            <li>
                                <a class="d-inline-flex align-items-center rounded collapsed"
                                   href="php042Transmission.html">B - Notion de formulaire
                                </a>
                            </li>
                            <li>
                                <a class="d-inline-flex align-items-center rounded collapsed"
                                   href="php043Transmission.html">C - $_GET et la transmission via l'URL
                                </a>
                            </li>
                            <li>
                                <a class="d-inline-flex align-items-center rounded collapsed"
                                   href="php044Transmission.html">D - $_POST et la transmission via un formulaire
                                </a>
                            </li>
                            <li>
                                <a class="d-inline-flex align-items-center rounded collapsed"
                                   href="php045Transmission.html">E - $_SESSION et la transmission via la session
                                </a>
                            </li>
                            <li>
                                <a class="d-inline-flex align-items-center rounded collapsed"
                                   href="php046Transmission.html">F - La transmission de données et sécurité
                                </a>
                            </li>
                        </ul>
                    </div>
                </li>
                <li class="mb-1 active">
                    <button class="btn d-inline-flex align-items-center rounded collapsed text-start"
                            data-bs-toggle="collapse" data-bs-target="#php05AccesSGBD_Introduction" aria-expanded="true"
                            aria-current="true">
                        V - Accéder à une base de données
                    </button>
                    <div class="collapse show" id="php05AccesSGBD_Introduction">

                        <ul class="list-unstyled fw-normal pb-1 small">
                            <li>
                                <a class="d-inline-flex align-items-center rounded collapsed"
                                   href="php05AccesSGBD_Introduction.html"> A - Introduction
                                </a>
                            </li>
                            <li>
                                <a class="d-inline-flex align-items-center rounded collapsed"
                                   href="php05AccesSGBD_Connexion.html">B - Connexion à la base de données
                                </a>
                            </li>
                            <li>
                                <a class="d-inline-flex align-items-center rounded collapsed"
                                   href="php05AccesSGBD_RappelSQL.html">C - Rappel SQL avec SELECT
                                </a>
                            </li>
                            <li>
                                <a class="d-inline-flex align-items-center rounded active"
                                   href="php05AccesSGBD_RqtSimple.html">D - query - Requêtes simples
                                </a>
                            </li>
                            <li>
                                <a class="d-inline-flex align-items-center rounded collapsed"
                                   href="php05AccesSGBD_RqtParam.html">E - prepare et execute - Requêtes avec paramètres
                                </a>
                            </li>
                            <li>
                                <a class="d-inline-flex align-items-center rounded collapsed" href="php05AccesSGBD_RqtLMD.html">F - Le cas particulier avec INSERT, UPDATE,
                                    DELETE et exec</a>
                            </li>
                        </ul>
                    </div>
                </li>
                <li class="mb-1">
                    <button class="btn d-inline-flex align-items-center rounded collapsed text-start justify-content-start"
                            data-bs-toggle="collapse" data-bs-target="#phpTP" aria-expanded="false">
                        TP - les bases du PHP
                    </button>
                    <div class="collapse" id="phpTP">
                        <ul class="list-unstyled fw-normal pb-1 small">
                            <li>
                                <a class="d-inline-flex align-items-center rounded collapsed"
                                   href="tp01htmlPhpNew.html">
                                    TP01 - Affichage, déclaration de variables, tableaux
                                </a>
                            </li>
                            <li>
                                <a class="d-inline-flex align-items-center rounded collapsed" href="tp02htmlPhpNew.html">
                                    TP02 - Tableaux, Boucles, formulaires
                                </a>
                            </li>
                            <li>
                                <a class="d-inline-flex align-items-center rounded collapsed" href="tp03htmlPhpNew.html">
                                    TP03 - Tableaux Associatifs, Boucles foreach
                                </a>
                            </li>
                            <li>
                                <a class="d-inline-flex align-items-center rounded collapsed" href="tp04htmlPhpNew.html">
                                    TP04 - Pattern MVC

                                </a>
                            </li>
                            <li>
                                <a class="d-inline-flex align-items-center rounded collapsed" href="tp05htmlPhpNew.html">
                                    TP05 - Pattern MVC, Session

                                </a>
                            </li>
                            <li>
                                <a class="d-inline-flex align-items-center rounded collapsed" href="tp06htmlPhpNew.html">
                                    TP06 - Pattern MVC, connexion à un SGBD
                                </a>
                            </li>
                        </ul>
                    </div>
                </li>
                <li class="mb-1">
                    <button class="btn d-inline-flex align-items-center rounded collapsed text-start justify-content-start"
                            data-bs-toggle="collapse" data-bs-target="#phpEx" aria-expanded="false">
                        Exercices sur le MVC
                    </button>
                    <div class="collapse" id="phpEx">
                        <ul class="list-unstyled fw-normal pb-1 small">
                            <li>
                                <a class="d-inline-flex align-items-center rounded collapsed" href="ex01htmlPhp.html">
                                    Ex01 - Modifier un site en fonction du pattern MVC
                                </a>
                            </li>
                            <li>
                                <a class="d-inline-flex align-items-center rounded collapsed"
                                   href="ex02htmlPhp.html">
                                    Ex02 - Création d'un contrôleur
                                </a>
                            </li>
                        </ul>
                    </div>
                </li>
            </ul>
        </nav>
    </aside>
    <!--        Page de cours-->
    <main class="bd-main order-1">
        <!--            Titre-->
        <div class="bd-intro ps-lg-4">
            <div class="d-md-flex flex-md-row align-items-center justify-content-between">
                <h1 class="bd-title" id="content"> V - Accéder à une base de données</h1>
            </div>
        </div>
        <!--        Menu droite-->
        <div class="bd-toc mt-4 mb-5 my-md-0 ps-xl-3 mb-lg-5 text-muted">
            <strong class="d-block h6 my-2 pb-2 border-bottom">Dans cette page</strong>
            <nav id="TableOfContents">
                <ul>
                    <li><a href="#ligneseule">1 - Le cas où une seule ligne est renvoyée</a></li>
                    <li><a href="#lignPlusieurs">2 - Le cas où plusieurs lignes sont renvoyées</a>
                    </li>

                </ul>
            </nav>
        </div>

        <!--            Docs-->
        <div class="bd-content ps-lg-4">
            <h2 id="sgbdRequeteSimple">D - <code>query</code> - Requêtes simples</h2>
            <section>
                <p>La méthode <code>query</code> de la classe <code>PDO</code> permet d'exécuter une requête SQL
                    simple (sans paramètres).</p>
                <div class="highlight"><pre class="chroma"><code class="language-php" data-lang="php"><span
                        class="c">// ...</span>
$requete = "<span class="cp">select</span> * <span class="cp">from</span> employe";
$resultat = $bdd-&gt;<span class="s">query</span>($requete);</code></pre>
                </div>
                <p>Le symbole <code>-&gt;</code> est l'équivalent PHP du symbole <code>.</code> utilisé dans
                    d'autres langages comme Java ou C#.
                    <br>L'instruction <code>$bdd-&gt;query</code> se lit : "J'appelle la
                    méthode <code>query</code> sur mon objet <code>$bdd</code>".</p>
                <p>Après l'appel à <code>query</code>, on peut parcourir le résultat ligne par ligne en appelant à
                    la
                    méthode <code>fetch</code> sur le résultat de la requête.</p>
                <h3 id="ligneseule">1 - Le cas où une seule ligne est renvoyée</h3>
                <article>
                    <ul>
                        <li>Dans le cas d'une requête qui renvoie une seule ligne de résultat, un seul appel à
                            <code>fetch</code> suffit. C'est notamment le cas lorsqu'on recherche un enregistrement à
                            partir
                            de sa clé primaire.
                        </li>
                    </ul>
                    <div class="highlight"><pre class="chroma"><code class="language-php" data-lang="php"><span
                            class="c">// ...</span>
$requete = "<span class="cp">select</span> * <span class="cp">from</span> employe <span class="cp">where</span> id=1;";
$resultat = $bdd-&gt;<span class="s">query</span>($requete);
$ligne = $resultat-&gt;<span class="s">fetch</span>();
<span class="c">// On accède à la valeur de macolonne avec $ligne['macolonne'];</span></code></pre>
                    </div>
                </article>
                <h3 id="lignPlusieurs">2 - Le cas où plusieurs lignes sont renvoyées</h3>
                <article>
                    <ul>
                        <li>Si la requête renvoie plusieurs lignes de résultats, on peut itérer sur ces lignes avec une
                            boucle <code>while</code> ou une boucle <code>foreach</code>.
                        </li>
                    </ul>
                    <h5> boucle <code>while</code></h5>
                    <div class="highlight"><pre class="chroma"><code class="language-php" data-lang="php"><span
                            class="c">// ...</span>
$requete = "<span class="cp">select</span> * <span class="cp">from</span> employe";
$resultat = $bdd-&gt;<span class="s">query</span>($requete);

<span class="c">// Itération sur les résultats de la requête SQL</span>
<span class="s">while</span>($ligne = $resultat-&gt;<span class="s">fetch</span>()) {
    <span class="c">// On accède à la valeur de macolonne avec $ligne['macolonne'];</span>
    <span class="c">// ...</span>
}</code></pre>
                    </div>
                    <h5> boucle <code>foreach</code></h5>
                    <div class="highlight"><pre class="chroma"><code class="language-php" data-lang="php"><span
                            class="c">// ...</span>
$requete = "<span class="cp">select</span> * <span class="cp">from</span> employe";
$resultat = $bdd-&gt;<span class="s">query</span>($requete);

<span class="c">// Récupération de tous les résultats de la requête dans un tableau</span>
$donnees = $resultat-&gt;<span class="s">fetchAll</span>();
<span class="c">// Itération sur le contenu du tableau</span>
<span class="s">foreach</span>($donnees <span class="s">as</span> $ligne) {
    <span class="c">// On accède à la valeur de macolonne avec $ligne['macolonne'];</span>
    <span class="c">// ...</span>
}</code></pre>
                    </div>
                    <p>Dans tous les cas, la variable <code>$ligne</code> s'utilise comme un tableau associatif. Elle
                        rassemble les valeurs des différentes colonnes pour une ligne de résultat SQL.</p>
                    <div class="bd-callout bd-callout-warning">
                        <h4><code>fetch</code> ou <code>fetchAll</code></h4>
                        <p><code>fetch</code> est utilisé dans le cas où vous êtes <strong>sûr</strong> que votre
                            requête
                            renvoie une seule ligne.</p>
                        <p><code>fetchAll</code> est utilisé dans le cas où la requête vous renvoie plusieurs lignes.
                            Généralement c'est un tableau qui est renvoyé. Mais avec la gestion des paramètres il est
                            possible d'obtenir un objet, par exemple.</p>
                    </div>
                </article>
            </section>
        </div>
    </main>
</div>
<script src="../dist/5.0/js/bootstrap.bundle.min.js"></script>
<script src="../dist/5.0/js/docs.min.js"></script>
</body>
</html>